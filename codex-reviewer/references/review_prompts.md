# レビュープロンプトテンプレート集

このドキュメントには、各レビュータイプに対応した詳細なプロンプトテンプレートを記載しています。

## 1. コードレビュープロンプト

### 1.1 一般的なコードレビュー

```
以下のコードを詳細にレビューしてください。

## レビュー観点
1. **セキュリティ**: OWASP Top 10、CWE、インジェクション脆弱性、認証・認可の問題
2. **パフォーマンス**: アルゴリズム効率、メモリ管理、N+1問題、キャッシュ戦略
3. **保守性**: コードの可読性、命名規則、適切なコメント、循環的複雑度
4. **ベストプラクティス**: 言語固有の規約、デザインパターン、SOLID原則
5. **エラーハンドリング**: 例外処理、エッジケース対応、入力検証
6. **テスト可能性**: 依存性注入、モック可能性、単体テスト容易性

## 出力形式
各問題について以下の形式で報告:
- **重要度**: Critical / High / Medium / Low
- **カテゴリ**: 該当カテゴリ
- **場所**: ファイル名:行番号
- **問題**: 具体的な問題の説明
- **推奨**: 改善案とコード例

対象ファイル: {target}
```

### 1.2 セキュリティ重点レビュー

```
以下のコードのセキュリティレビューを実施してください。

## セキュリティチェック項目
1. **インジェクション対策**
   - SQLインジェクション（パラメータ化クエリ使用確認）
   - コマンドインジェクション（シェル実行の安全性）
   - XSS（出力エンコーディング、CSP）
   - LDAP/XML/XPathインジェクション

2. **認証・認可**
   - 認証ロジックの実装
   - セッション管理
   - アクセス制御チェック
   - 権限昇格の可能性

3. **データ保護**
   - 機密データの暗号化
   - パスワードハッシュ（bcrypt/scrypt/Argon2）
   - シークレット管理
   - ログへの機密情報漏洩

4. **入力検証**
   - 入力値のバリデーション
   - ファイルアップロードの安全性
   - デシリアライゼーション

5. **エラー処理**
   - スタックトレースの露出
   - エラーメッセージの情報漏洩

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **CWE ID**: 該当する場合
- **場所**: ファイル名:行番号
- **脆弱性**: 脆弱性の種類と説明
- **攻撃シナリオ**: 想定される攻撃方法
- **修正方法**: 具体的な修正コード

対象: {target}
```

### 1.3 パフォーマンス重点レビュー

```
以下のコードのパフォーマンスレビューを実施してください。

## パフォーマンスチェック項目
1. **アルゴリズム効率**
   - 時間計算量（Big O表記で評価）
   - 空間計算量
   - 不要なループ、再計算

2. **データベースアクセス**
   - N+1問題
   - インデックス活用
   - クエリ最適化
   - コネクション管理

3. **メモリ管理**
   - メモリリーク
   - 大量データのストリーム処理
   - オブジェクト生成コスト

4. **I/O効率**
   - ファイルI/O最適化
   - ネットワーク呼び出し
   - バッファリング

5. **並行処理**
   - 並列化の機会
   - 非同期処理の活用
   - ロック競合

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **場所**: ファイル名:行番号
- **問題**: パフォーマンス問題の説明
- **影響**: 予想される影響（レイテンシ、スループット等）
- **最適化案**: 具体的な改善コード

対象: {target}
```

## 2. ドキュメントレビュープロンプト

### 2.1 技術仕様書レビュー

```
以下の技術仕様書をレビューしてください。

## レビュー観点
1. **完全性**
   - 必要なセクションの網羅性
   - 機能要件の完全な記述
   - 非機能要件の記載
   - 制約・前提条件の明記

2. **正確性**
   - 技術的な正しさ
   - 用語の正確な使用
   - 数値・計算の正確性
   - 矛盾する記述がないか

3. **明確性**
   - 曖昧な表現がないか
   - 専門用語の定義
   - 図表の適切な使用
   - 読者対象に適した記述レベル

4. **一貫性**
   - 用語の統一
   - フォーマットの統一
   - 命名規則の統一

5. **実装可能性**
   - 実装に必要な情報の十分さ
   - 技術的制約との整合性
   - 見積り可能性

6. **トレーサビリティ**
   - 要件IDの付与
   - 上位要件との関連
   - テストケースとの対応

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **カテゴリ**: 完全性/正確性/明確性/一貫性/実装可能性/トレーサビリティ
- **場所**: セクション名または行番号
- **問題**: 問題の説明
- **推奨**: 改善提案

対象: {target}
```

### 2.2 API仕様書レビュー

```
以下のAPI仕様書をレビューしてください。

## レビュー観点
1. **エンドポイント設計**
   - RESTful原則への準拠
   - HTTPメソッドの適切な使用
   - URL設計の一貫性
   - バージョニング戦略

2. **リクエスト/レスポンス**
   - 必須/任意パラメータの明記
   - データ型・フォーマットの定義
   - バリデーションルール
   - サンプルデータの提供

3. **エラーハンドリング**
   - エラーコードの体系
   - エラーメッセージの適切さ
   - HTTPステータスコードの使用

4. **認証・認可**
   - 認証方式の明記
   - 必要な権限の記載
   - トークン管理

5. **パフォーマンス・制限**
   - レート制限
   - ペイロードサイズ制限
   - タイムアウト設定

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **エンドポイント**: 該当APIエンドポイント
- **問題**: 問題の説明
- **推奨**: 改善提案

対象: {target}
```

## 3. 設計レビュープロンプト

### 3.1 システムアーキテクチャレビュー

```
以下のシステムアーキテクチャ設計をレビューしてください。

## レビュー観点
1. **アーキテクチャパターン**
   - 採用パターンの妥当性
   - パターンの正しい適用
   - 代替パターンとの比較

2. **コンポーネント分割**
   - 責務の明確さ
   - 結合度（低結合が望ましい）
   - 凝集度（高凝集が望ましい）
   - 循環依存の有無

3. **スケーラビリティ**
   - 水平スケーリング可能性
   - 垂直スケーリングの限界
   - ボトルネックの特定
   - 負荷分散戦略

4. **可用性・耐障害性**
   - 単一障害点（SPOF）
   - フェイルオーバー戦略
   - データ冗長性
   - 障害復旧手順

5. **セキュリティ**
   - 境界防御
   - 認証・認可アーキテクチャ
   - データフロー上のセキュリティ
   - シークレット管理

6. **運用性**
   - 監視・ロギング
   - デプロイ容易性
   - 設定管理
   - トラブルシューティング容易性

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **対象**: コンポーネント/レイヤー/インターフェース
- **問題**: アーキテクチャ上の懸念
- **リスク**: 想定されるリスク
- **推奨**: 改善提案

対象: {target}
```

## 4. テストレビュープロンプト

### 4.1 テストコードレビュー

```
以下のテストコードをレビューしてください。

## レビュー観点
1. **テストカバレッジ**
   - ステートメントカバレッジ
   - ブランチカバレッジ
   - 条件カバレッジ
   - カバーされていないコードパス

2. **テストケース品質**
   - 正常系テストの網羅性
   - 異常系テストの網羅性
   - 境界値テスト
   - エッジケースの考慮

3. **テスト独立性**
   - テスト間の依存関係
   - テスト実行順序への依存
   - 共有状態の問題
   - テストデータの分離

4. **アサーション**
   - アサーションの適切さ
   - 一つのテストで一つの検証
   - エラーメッセージの明確さ

5. **保守性**
   - テストコードの可読性
   - セットアップ/ティアダウン
   - テストヘルパーの活用
   - マジックナンバーの回避

6. **モック・スタブ**
   - 外部依存の適切な分離
   - モックの過剰使用
   - 本物の動作との乖離

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **テストファイル**: ファイル名
- **テスト名**: テスト関数/メソッド名
- **問題**: テストの問題点
- **推奨**: 改善提案

対象: {target}
```

### 4.2 テスト計画レビュー

```
以下のテスト計画をレビューしてください。

## レビュー観点
1. **スコープ**
   - テスト対象の明確さ
   - テスト除外項目の妥当性
   - リスクベースの優先順位付け

2. **テスト戦略**
   - テストレベル（単体/結合/E2E）の定義
   - テストタイプ（機能/非機能）のカバー
   - 自動化方針

3. **リソース計画**
   - テスト環境の定義
   - テストデータ準備
   - 必要スキル・ツール

4. **スケジュール**
   - マイルストーンの設定
   - 依存関係の考慮
   - バッファの確保

5. **品質基準**
   - 完了基準の明確さ
   - 合否判定基準
   - メトリクス定義

6. **リスク管理**
   - テストリスクの特定
   - 緩和策

## 出力形式
- **重要度**: Critical / High / Medium / Low
- **セクション**: 該当セクション
- **問題**: 計画の問題点
- **推奨**: 改善提案

対象: {target}
```

## 5. カスタムプロンプトの作成ガイドライン

### 効果的なプロンプト構造

1. **明確な指示**: 何をレビューするか明確に
2. **観点の列挙**: チェック項目を具体的に
3. **出力形式の指定**: 構造化された出力を要求
4. **対象の明示**: `{target}`プレースホルダーを使用

### プロンプトのカスタマイズ例

```
# プロジェクト固有のレビュープロンプト

以下のコードをレビューしてください。
当プロジェクトの規約に従って評価を行います。

## プロジェクト規約
- コーディングスタイル: PEP 8
- 命名規則: snake_case（変数・関数）、PascalCase（クラス）
- ドキュメント: Googleスタイルdocstring必須
- テスト: pytest使用、カバレッジ80%以上

## 追加チェック項目
- ロギング規約への準拠
- 設定管理方式の統一
- エラーハンドリングパターンの統一

対象: {target}
```
