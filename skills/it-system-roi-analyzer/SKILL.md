---
name: it-system-roi-analyzer
description: ITシステム導入・刷新のROI（投資対効果）分析スキル。ERP、CRM、クラウド移行、基幹システム刷新、DXプロジェクト等のビジネスケース作成を支援。TCO分析、NPV/IRR計算、感度分析、経営層向けROIレポート生成を実行。「システムROI」「IT投資評価」「クラウド移行コスト」「TCO分析」「DX投資効果」等のトリガーで使用。
---

# IT System ROI Analyzer

## Overview

ITシステム導入・刷新プロジェクトのROI（投資対効果）を体系的に分析し、経営層への説得力あるビジネスケースを作成するスキル。

**対象システム:**
- ERP/基幹システム刷新
- CRM/SFA導入
- クラウド移行（オンプレ→クラウド）
- レガシーシステム更新
- DX/デジタル化プロジェクト
- セキュリティ強化
- BI/分析基盤構築

**主要機能:**
- 現状（As-Is）コスト分析
- 5年間TCO（総所有コスト）算出
- 効果の定量化（コスト削減、生産性向上、リスク低減）
- 財務指標計算（ROI, NPV, IRR, 回収期間）
- 感度分析（楽観/標準/悲観シナリオ）
- 日本語・英語レポート生成

---

## When to Use This Skill

このスキルは以下の場面で使用：

1. **新規システム導入の投資判断**
   - 「ERPシステム導入のROIを算出して」
   - 「CRM導入のビジネスケースを作成して」

2. **システム刷新・更新の投資評価**
   - 「基幹システム刷新の投資対効果を分析して」
   - 「レガシーシステム更新のコスト比較をして」

3. **クラウド移行の費用対効果**
   - 「オンプレからクラウドへの移行コストを試算して」
   - 「AWS移行のTCO比較をして」

4. **DXプロジェクトの投資判断**
   - 「デジタル化投資のNPV/IRRを計算して」
   - 「DXプロジェクトの効果を定量化して」

5. **経営層への提案資料作成**
   - 「経営会議向けのIT投資提案書を作成して」
   - 「取締役会向けのROIレポートを作成して」

---

## Core Workflow 1: 現状分析 (As-Is Analysis)

現行システムのコスト構造と課題を把握する。

### Step 1: 現行コストの収集

以下の情報を収集・整理：

**直接コスト:**
| コスト項目 | 内容 | 算出方法 |
|-----------|------|----------|
| ハードウェア | サーバー、ストレージ、ネットワーク機器 | 減価償却費 + リース費用 |
| ソフトウェア | ライセンス費、保守費 | 年間契約額 |
| 運用人件費 | 運用担当者、ヘルプデスク | FTE × 年間人件費 |
| 保守・サポート | ベンダー保守、サポート契約 | 年間契約額 |
| インフラ | データセンター、電力、空調 | 施設費用按分 |

**間接コスト:**
| コスト項目 | 内容 | 算出方法 |
|-----------|------|----------|
| ダウンタイム | システム停止による損失 | 停止時間 × 時間当たり損失 |
| エラー対応 | 障害対応、データ修正 | 対応工数 × 時間単価 |
| 非効率 | 手作業、二重入力 | 作業工数 × 時間単価 |

### Step 2: 課題・ペインポイントの特定

定性的課題を定量化：

```
課題: 月次決算に5日かかる
定量化: 5日 × 8時間 × 5人 × 月12回 × 3,000円/時間 = 720万円/年の人件費
```

### Step 3: ベースラインの確立

5年間の現状維持コスト（Do-Nothingシナリオ）を算出。

参照: `references/it_roi_methodology.md`

---

## Core Workflow 2: 投資額算出 (Investment Calculation)

新システム導入に必要な投資額を算出する。

### Step 1: 初期投資の見積もり

| 投資項目 | 内容 | 目安 |
|---------|------|------|
| システム開発費 | 要件定義、設計、開発、テスト | ベンダー見積 |
| パッケージ/SaaS | 初期ライセンス、導入費用 | ベンダー見積 |
| インフラ構築 | クラウド/オンプレ環境構築 | 構成に依存 |
| データ移行 | 既存データの移行・変換 | データ量に依存 |
| トレーニング | ユーザー教育、マニュアル作成 | ユーザー数に依存 |
| コンサルティング | PMO、導入支援 | 規模の15-20% |
| コンティンジェンシー | 予備費 | 総額の10-15% |

### Step 2: ランニングコストの見積もり（5年間）

| コスト項目 | 算出方法 |
|-----------|----------|
| 保守費用 | 開発費の15-20%/年 |
| クラウド利用料 | 構成・利用量に依存 |
| ライセンス費 | 年間契約額 |
| 運用人件費 | 運用体制に依存 |
| サポート費用 | 契約額 |

### Step 3: TCO（総所有コスト）算出

5年間の総コストを算出。

参照: `references/tco_analysis_guide.md`
テンプレート: `assets/tco_breakdown_template.md`

---

## Core Workflow 3: 効果定量化 (Benefit Quantification)

システム導入による効果を定量的に算出する。

### Step 1: コスト削減効果

| 効果項目 | 算出式 | 例 |
|---------|--------|-----|
| 人件費削減 | 削減工数 × 時間単価 | 月100時間削減 × 3,000円 × 12ヶ月 = 360万円/年 |
| IT運用コスト削減 | 旧コスト - 新コスト | サーバー費1,000万円→500万円 = 500万円/年削減 |
| 保守費削減 | 旧保守費 - 新保守費 | ベンダー保守300万円→100万円 = 200万円/年削減 |
| ライセンス削減 | 削減ライセンス費 | 旧ツール200万円→統合で不要 = 200万円/年削減 |

### Step 2: 生産性向上効果

| 効果項目 | 算出式 | 例 |
|---------|--------|-----|
| 処理時間短縮 | 短縮時間 × 単価 × 回数 | 10分短縮 × 3,000円/時 × 月1,000回 = 500万円/年 |
| エラー削減 | 削減件数 × 修正コスト | 月50件→5件、5万円/件 = 270万円/年削減 |
| 意思決定迅速化 | 機会損失削減 | リードタイム短縮による機会獲得 |

### Step 3: リスク低減効果

| 効果項目 | 算出式 | 例 |
|---------|--------|-----|
| セキュリティリスク | 損失額 × 確率低減 | 情報漏洩リスク1億円 × 発生率5%低減 = 500万円/年相当 |
| 可用性向上 | ダウンタイム削減 × 損失 | 停止時間年10時間→1時間、100万円/時間 = 900万円/年 |
| コンプライアンス | 違反リスク低減 | 罰金・訴訟リスク低減 |

### Step 4: 売上貢献効果（該当する場合）

| 効果項目 | 算出式 | 例 |
|---------|--------|-----|
| 新規顧客獲得 | 増加顧客数 × LTV | EC強化で月10顧客増 × LTV 50万円 = 6,000万円/年 |
| 顧客単価向上 | 単価増 × 顧客数 | レコメンドで平均1,000円増 × 月1万件 = 1.2億円/年 |
| 解約率低減 | 保持顧客 × 年間売上 | 解約率5%低減 × 顧客売上1億円 = 500万円/年 |

参照: `references/benefit_quantification.md`

---

## Core Workflow 4: 財務指標算出 (Financial Metrics)

投資判断のための財務指標を算出する。

### Step 1: キャッシュフロー表の作成

5年間のキャッシュフロー予測：

| 年 | 初期投資 | 年間効果 | 運用コスト | 純キャッシュフロー | 累積CF |
|----|---------|---------|-----------|------------------|--------|
| 0年 | ▲5,000万円 | - | - | ▲5,000万円 | ▲5,000万円 |
| 1年 | - | 2,000万円 | ▲500万円 | 1,500万円 | ▲3,500万円 |
| 2年 | - | 2,500万円 | ▲500万円 | 2,000万円 | ▲1,500万円 |
| 3年 | - | 2,500万円 | ▲500万円 | 2,000万円 | 500万円 |
| 4年 | - | 2,500万円 | ▲500万円 | 2,000万円 | 2,500万円 |
| 5年 | - | 2,500万円 | ▲500万円 | 2,000万円 | 4,500万円 |

### Step 2: ROI計算

```
ROI (%) = ((5年間総効果 - 5年間総投資) / 5年間総投資) × 100

例:
総効果 = 12,000万円
総投資 = 5,000万円 + 2,500万円（運用5年） = 7,500万円
ROI = ((12,000 - 7,500) / 7,500) × 100 = 60%
```

**ROI判断基準:**
- 100%以上: 非常に良い
- 50-100%: 良い
- 20-50%: 許容範囲
- 20%未満: 要再検討

### Step 3: NPV計算

```
NPV = Σ (CFt / (1 + r)^t) - 初期投資

例（割引率10%）:
NPV = -5,000万円
    + 1,500万円/(1.10)^1
    + 2,000万円/(1.10)^2
    + 2,000万円/(1.10)^3
    + 2,000万円/(1.10)^4
    + 2,000万円/(1.10)^5
    = 1,847万円
```

**NPV判断基準:**
- NPV > 0: 投資価値あり（採用推奨）
- NPV = 0: 投資と効果が同等
- NPV < 0: 投資価値なし（非推奨）

### Step 4: IRR計算

NPVがゼロになる割引率を算出。

```
IRR = 約28%（Newton-Raphson法で算出）
```

**IRR判断基準:**
- IRR > WACC（資本コスト）: 投資価値あり
- 一般的目標: 15-20%以上

### Step 5: 投資回収期間

累積キャッシュフローがゼロになる時点。

```
回収期間 = 2年 + (1,500万円 / 2,000万円) = 2.75年
```

**回収期間判断基準:**
- 3年以内: 良好
- 3-5年: 許容範囲
- 5年超: リスク高い

スクリプト: `scripts/it_roi_calculator.py`

---

## Core Workflow 5: 感度分析 (Sensitivity Analysis)

前提条件の変動による影響を分析する。

### Step 1: シナリオ定義

| シナリオ | 効果 | コスト | 確率 |
|---------|------|-------|------|
| 楽観 | +20% | -10% | 20% |
| 標準 | 計画値 | 計画値 | 60% |
| 悲観 | -20% | +10% | 15% |
| 最悪 | -30% | +20% | 5% |

### Step 2: シナリオ別財務指標

| シナリオ | NPV | ROI | IRR | 回収期間 |
|---------|-----|-----|-----|---------|
| 楽観 | 3,500万円 | 95% | 38% | 2.1年 |
| 標準 | 1,847万円 | 60% | 28% | 2.75年 |
| 悲観 | 500万円 | 25% | 15% | 3.5年 |
| 最悪 | ▲200万円 | ▲3% | 8% | 4.2年 |

### Step 3: 損益分岐点分析

- **効果が何%減少したらNPV=0になるか**: 効果が35%減少でNPV=0
- **コストが何%増加したらNPV=0になるか**: コストが45%増加でNPV=0

### Step 4: リスク評価と対策

| リスク | 確率 | 影響 | 対策 |
|--------|------|------|------|
| 導入遅延 | 中 | 高 | アジャイル開発、フェーズ分割 |
| 効果発現遅延 | 中 | 中 | 変更管理、トレーニング強化 |
| コスト超過 | 中 | 中 | コンティンジェンシー確保 |
| 要件変更 | 高 | 中 | スコープ管理厳格化 |

---

## Core Workflow 6: ROI資料生成 (Report Generation)

経営層向けのROI提案資料を作成する。

### Step 1: レポート構成

1. **エグゼクティブサマリー**（1ページ）
   - 投資概要、主要財務指標、推奨

2. **現状分析**（1-2ページ）
   - 現行コスト、課題、Do-Nothingリスク

3. **投資計画**（1-2ページ）
   - 初期投資、TCO、スケジュール

4. **効果予測**（1-2ページ）
   - 定量効果、定性効果

5. **財務分析**（1-2ページ）
   - ROI, NPV, IRR, 回収期間、キャッシュフロー

6. **感度分析**（1ページ）
   - シナリオ別結果、リスク評価

7. **推奨と次のステップ**（1ページ）
   - 投資推奨、承認後アクション

### Step 2: テンプレート使用

日本語: `assets/roi_report_template_ja.md`
英語: `assets/roi_report_template_en.md`

### Step 3: ビジュアル要素

- キャッシュフローグラフ（棒グラフ）
- 感度分析チャート（トルネードチャート）
- 投資回収曲線（累積CFグラフ）

---

## Python Script Usage

`scripts/it_roi_calculator.py`を使用したCLI計算：

### 基本的なROI計算

```bash
python it_roi_calculator.py --investment 50000000 --annual-benefit 15000000 --years 5 --rate 0.10
```

### JSON入力での詳細計算

```bash
python it_roi_calculator.py --input project_data.json --output report.md
```

**入力JSONフォーマット:**
```json
{
  "project_name": "基幹システム刷新",
  "initial_investment": 50000000,
  "annual_operating_cost": 5000000,
  "annual_benefits": {
    "year1": 12000000,
    "year2": 18000000,
    "year3": 20000000,
    "year4": 20000000,
    "year5": 20000000
  },
  "discount_rate": 0.10
}
```

---

## Best Practices

### 1. 保守的に見積もる
- 効果は控えめに（達成確度80%以上）
- コストは余裕を持って（コンティンジェンシー15%）
- 効果発現は段階的に（1年目50%、2年目以降100%）

### 2. 定量化に拘る
- 可能な限り金額換算
- 定量化困難な効果は「追加価値」として別記
- 財務指標計算には確実な定量効果のみ使用

### 3. 複数シナリオを提示
- 悲観ケースでも投資価値があることを示す
- リスク対策を明記

### 4. ステークホルダー別説明
- **経営層**: エグゼクティブサマリー、戦略的価値
- **財務部門**: NPV, IRR, キャッシュフロー
- **IT部門**: 技術的実現可能性、運用コスト
- **事業部門**: 業務改善効果

---

## Resources

### Scripts
- `scripts/it_roi_calculator.py` - ROI/NPV/IRR計算CLI

### References
- `references/it_roi_methodology.md` - IT ROI分析の方法論
- `references/tco_analysis_guide.md` - TCO分析ガイド
- `references/benefit_quantification.md` - 効果定量化ガイド

### Templates
- `assets/roi_report_template_ja.md` - 日本語ROIレポート
- `assets/roi_report_template_en.md` - 英語ROIレポート
- `assets/tco_breakdown_template.md` - TCO内訳テンプレート

---

## Quick Reference

### 財務指標の計算式

| 指標 | 計算式 | 判断基準 |
|------|--------|----------|
| ROI | (総効果 - 総投資) / 総投資 × 100 | >50% 良好 |
| NPV | Σ(CFt / (1+r)^t) - 初期投資 | >0 採用 |
| IRR | NPV=0となる割引率 | >WACC 採用 |
| 回収期間 | 累積CF=0となる年数 | <3年 良好 |

### 割引率の目安

| リスクレベル | 割引率 |
|-------------|--------|
| 低リスク | 8-10% |
| 標準 | 10-12% |
| 高リスク | 15-20% |
