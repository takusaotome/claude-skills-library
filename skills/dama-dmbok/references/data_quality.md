# Data Quality（データ品質）

## 概要

データ品質は、データが使用目的に適合しているかを測定・管理する知識領域です。信頼できるデータなしには、正確な分析も意思決定もできません。

---

## データ品質の定義

> データがその使用目的に適合している度合い。
> "Fitness for Purpose"

---

## 品質次元（Quality Dimensions）

### DAMA 6つの基本次元

| 次元 | 英語 | 定義 | 測定方法 |
|------|------|------|----------|
| **正確性** | Accuracy | 現実世界を正しく反映 | 外部ソースとの照合 |
| **完全性** | Completeness | 必要なデータが揃っている | NULL/空白率 |
| **一貫性** | Consistency | システム間・時間軸で矛盾なし | 不一致件数 |
| **適時性** | Timeliness | 必要な時に利用可能 | 遅延時間 |
| **一意性** | Uniqueness | 重複がない | 重複率 |
| **妥当性** | Validity | 定義されたルール・形式に適合 | 違反率 |

### 追加の品質次元

| 次元 | 説明 |
|------|------|
| 鮮度（Currency） | 最新の状態に更新されている |
| 整合性（Integrity） | 参照整合性が保たれている |
| 適合性（Conformity） | 標準フォーマットに適合 |
| 信頼性（Reliability） | データソースが信頼できる |
| 可用性（Availability） | 必要な時にアクセス可能 |

---

## 品質管理プロセス

### データ品質ライフサイクル

```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│  定義    │───▶│  測定    │───▶│  分析    │───▶│  改善    │
│ Define   │    │ Measure  │    │ Analyze  │    │ Improve  │
└──────────┘    └──────────┘    └──────────┘    └──────────┘
     │                                               │
     │              ┌──────────┐                    │
     └─────────────│  監視    │◀───────────────────┘
                   │ Monitor  │
                   └──────────┘
```

### 1. 定義（Define）

**品質要件の定義:**
- ビジネス要件からの品質要件導出
- 重要データ要素（CDE）の特定
- 品質閾値の設定

**品質ルールの種類:**

| タイプ | 説明 | 例 |
|--------|------|-----|
| **形式ルール** | データ形式の検証 | 郵便番号は7桁数字 |
| **範囲ルール** | 値の範囲の検証 | 年齢は0-150 |
| **必須ルール** | 必須項目の検証 | 顧客名は必須 |
| **参照ルール** | 参照整合性の検証 | 顧客IDがマスタに存在 |
| **一貫性ルール** | システム間整合性 | CRMとERPの顧客数一致 |
| **業務ルール** | ビジネスロジック | 受注日≤出荷日 |

### 2. 測定（Measure）

**プロファイリング項目:**

```
基本統計
├── レコード数
├── カラム数
├── NULL率
├── 空白率
├── 最小/最大/平均値
└── カーディナリティ

パターン分析
├── 値の分布
├── フォーマット一貫性
├── 外れ値
└── 頻出パターン

関係分析
├── 参照整合性
├── 依存関係
├── 重複検出
└── 孤立レコード
```

**品質スコアの計算:**
```
品質スコア = 適合レコード数 / 総レコード数 × 100%

例: 完全性スコア
= (NULLでないレコード数) / (総レコード数) × 100%
= 9,500 / 10,000 × 100% = 95%
```

### 3. 分析（Analyze）

**根本原因分析:**

| 原因カテゴリ | 例 |
|-------------|-----|
| **入力時** | 入力ミス、バリデーション不足 |
| **処理時** | ETLバグ、変換エラー |
| **設計時** | データモデル不備、制約不足 |
| **運用時** | 更新漏れ、同期遅延 |
| **外部要因** | ソースデータの品質問題 |

**影響分析:**
- 影響を受ける業務プロセス
- 影響を受ける下流システム
- ビジネスインパクト（金額換算）

### 4. 改善（Improve）

**改善アプローチ:**

| アプローチ | 説明 | 例 |
|-----------|------|-----|
| **予防** | 問題の発生を防ぐ | 入力バリデーション強化 |
| **検出** | 問題を早期発見 | 品質モニタリング |
| **修正** | 既存の問題を修正 | データクレンジング |

**データクレンジング手法:**
- 標準化（Standardization）
- 名寄せ（Matching）
- 重複排除（Deduplication）
- 補完（Enrichment）
- 削除（Deletion）

### 5. 監視（Monitor）

**品質ダッシュボード:**

```
┌─────────────────────────────────────────────────────────┐
│              データ品質ダッシュボード                    │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  全体品質スコア: 94.2%  ▲ +1.3% (前月比)               │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 品質トレンド                                    │   │
│  │     100% ┤                                      │   │
│  │      95% ┤    ●────●────●────●                │   │
│  │      90% ┤ ●──                                 │   │
│  │          └────────────────────────────────────  │   │
│  │            1月   2月   3月   4月   5月          │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  データセット別スコア:                                  │
│  ├── 顧客マスタ    95% ████████████████████░░░        │
│  ├── 商品マスタ    98% █████████████████████░         │
│  ├── 取引データ    88% █████████████████░░░░░░        │
│  └── 在庫データ    92% ██████████████████░░░░         │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 品質スコアカード

### テンプレート

```
┌──────────────────────────────────────────────────────────────┐
│                   データ品質スコアカード                      │
│                   対象: 顧客マスタ                           │
│                   評価日: 2024-01-15                         │
├──────────────────────────────────────────────────────────────┤
│ 品質次元        │ 目標  │ 実績  │ 状態  │ トレンド          │
├─────────────────┼───────┼───────┼───────┼──────────────────┤
│ 正確性          │ 98%   │ 96%   │  ⚠️   │ ↗ 改善中         │
│ 完全性          │ 99%   │ 99.5% │  ✅   │ → 安定           │
│ 一貫性          │ 95%   │ 93%   │  ⚠️   │ ↘ 要注意         │
│ 適時性          │ 100%  │ 100%  │  ✅   │ → 安定           │
│ 一意性          │ 100%  │ 99.8% │  ✅   │ → 安定           │
│ 妥当性          │ 99%   │ 98%   │  ⚠️   │ ↗ 改善中         │
├─────────────────┼───────┼───────┼───────┼──────────────────┤
│ 総合スコア      │ 95%   │ 97.7% │  ✅   │                  │
└──────────────────────────────────────────────────────────────┘

凡例: ✅ 目標達成  ⚠️ 要改善  ❌ 重大問題
```

---

## 品質管理の組織

### 役割と責任

| 役割 | 責任 |
|------|------|
| **Data Quality Manager** | 品質プログラム全体の管理 |
| **Data Steward** | 領域の品質維持、問題解決 |
| **Data Analyst** | プロファイリング、分析 |
| **Data Engineer** | クレンジング、ETL改修 |
| **Business User** | 品質要件定義、検証 |

### RACI マトリクス

| 活動 | DQ Mgr | Steward | Analyst | Engineer |
|------|--------|---------|---------|----------|
| 品質要件定義 | A | R | C | I |
| プロファイリング | I | C | R | C |
| ルール定義 | A | R | R | C |
| 測定・監視 | I | C | R | R |
| 改善実施 | A | R | C | R |

---

## ツール・テクノロジー

### 品質管理ツールの機能

| 機能 | 説明 |
|------|------|
| プロファイリング | データの統計分析 |
| ルール定義 | 品質ルールの作成・管理 |
| 測定・スコアリング | 品質スコアの計算 |
| クレンジング | データ修正・変換 |
| モニタリング | 継続的な品質監視 |
| レポーティング | ダッシュボード、アラート |

### 主要ベンダー

- Informatica Data Quality
- IBM InfoSphere QualityStage
- Talend Data Quality
- Ataccama
- Great Expectations（OSS）
- dbt（テスト機能）
